SELECT
	ddf.TABLESPACE_NAME ,
	Sum(ddf.bytes) / 1024 / 1024 Total_MB, -- 仅仅标识已分配的空间大小，在自动扩展数据文件中，这种计算方式并不准确
	Sum(dfs.bytes) / 1024 / 1024 AS Free_MB,
	Round(( 1 - dfs.bytes / ddf.bytes ) * 100, 2) || '%' AS Used_Pct
FROM
	dba_free_space dfs,
	dba_data_files ddf
WHERE
	dfs.TABLESPACE_NAME = ddf.TABLESPACE_NAME
GROUP BY
	ddf.TABLESPACE_NAME
